文档 3：音源分发与设置流程（SoundFont / 默认出声）（v0.1）
1. 目标

用户首次打开就能出声

音源策略可发行、可合规、可扩展

音源丢失/加载失败有清晰兜底，不阻塞练习

2. 音源策略（v0.1 推荐）
2.1 内置最小兜底音色（必须）

内置一个“极简钢琴”或“beep 合成”兜底：

体积小（KB~MB）

不追求音质，只保证“能听到”

任何时候 SF2 失败，都自动回退到兜底音色，并提示用户

2.2 用户可选 SF2（Should）

引导用户选择本地 .sf2

加载成功后记住路径（SettingsDto.default_sf2_path）

提供“最近音源列表”（可选）

不建议 v0.1 内置大钢琴库：包体/授权/签名分发都会放大技术债。

3. 文件与路径规范

SF2 默认放在用户选择的路径，不强制拷贝（v0.1）

如用户选择“复制到应用资源库”：

复制到 App Data 目录（macOS: Application Support/Cadenza）

便于移动与备份（v0.2 可加）

4. Settings 流程
4.1 Onboarding

选择 Audio Output

选择 MIDI Input（可跳过）

音源：

默认使用内置兜底

可点击“选择 SF2”

测试区：按键出声（监听默认 On），显示 CC64 状态

完成进入 Practice

4.2 Settings > Audio

Output device 下拉

Buffer size（低延迟/稳定）

Master / Bus 音量

Monitor 开关

SoundFont 管理：

当前音源名称

切换/重新加载

恢复内置兜底

5. 错误与兜底（明确规则）

SF2 加载失败：

UI toast + 详细原因（文件不存在/格式不支持）

自动切回兜底音色（不中断运行）

切换输出设备失败：

保持旧设备继续播放（若可用）

否则进入“无声模式”但不崩溃，提示用户

6. 验收标准

冷启动无需配置即可“能出声”（兜底音色）

SF2 删除/移动后重新启动：

不崩溃

自动回退兜底，并提示重新选择